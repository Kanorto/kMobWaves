# kMobWaves - Плагин волн мобов для Minecraft

Плагин для создания системы волн спавна мифических мобов через MythicMobs API. Позволяет создавать последовательные волны мобов с настраиваемыми параметрами спавна, шансами появления и задержками между волнами.

Plagin dlya sozdaniya sistemy voln spavna mificheskikh mobov cherez MythicMobs API. Pozvolyayet sozdavat' posledovatel'nyye volny mobov s nastraivayemymi parametrami spavna, shansami poyavleniya i zaderzhkami mezhdu volnami.
210
A plugin for creating a spawn wave system for mythical mobs using the MythicMobs API. It allows you to create sequential mob waves with customizable spawn parameters, spawn chances, and delays between waves.

## Требования

- **Minecraft**: 1.21+
- **Сервер**: Paper или его форки
- **Зависимости**: MythicMobs 5.6.1+

## Установка

1. Скачайте плагин `kMobWaves.jar`
2. Поместите файл в папку `plugins/` вашего сервера
3. Перезапустите сервер
4. Настройте конфигурацию в файле `plugins/kMobWaves/config.yml`
5. Настройте сообщения в файле `plugins/kMobWaves/messages.yml`

## Конфигурация

### Основные настройки (config.yml)

```yaml
# Режим отладки (выводит подробную информацию в консоль) 
debug: false

# Система цветов для сообщений:
# LEGACY - цвета через & (&a, &c и т.д.)
# LEGACY_ADVANCED - LEGACY + hex через &## (&##FF5555)
# MINIMESSAGE - современный формат <color> (1.17+)
serializer: LEGACY

# Право которое требуется для выполнения команды info
# (Обязательно к заполнению, иначе команда не будет работать)
info_command_permission: "kmobwaves.user"

# Волны мобов
# count - Номер волны, указывать строго по порядку сверху вниз
# mobs - Список мобов волны, заполнять по формату: "Имя_Моба:шанс"
# coordinates - список координат на которых будут появляться мобы
# mobs-count - общее количество мобов на волне
# exceptions - время до начала следующей волны (Указывать в секундах)
# Количество волн в общей сумме - бесконечно.
Waves:
  - count: 1                    # Номер волны
    mobs:                       # Список мобов для спавна
      - "MobName:50"            # Формат: "Имя_Моба:шанс" (шанс от 0 до 100)
      - "AnotherMob:50"
    coordinates:                # Координаты спавна (x,y,z или world,x,y,z)
      - "100,100,100"
      - "200,100,200"
    mobs-count: 15              # Количество мобов в волне
    exceptions: 10              # Задержка перед следующей волной (в секундах)
  
  - count: 2
    mobs:
      - "BossMob:30"
      - "EliteMob:70"
    coordinates:
      - "100,100,100"
    mobs-count: 20
    exceptions: 15
```

### Формат мобов

- **Простой формат**: `"MobName"` - моб со 100% шансом спавна
- **С шансом**: `"MobName:50"` - моб с 50% шансом спавна
- Шансы суммируются и нормализуются автоматически

### Формат координат

- **Без указания мира**: `"100,100,100"` - используются координаты в первом доступном мире
- **С указанием мира**: `"world,100,100,100"` - координаты в указанном мире

### Настройка сообщений (messages.yml)

```yaml
system:
  no-permission: "&cУ тебя нет прав."
  reload-plugin: "&aБип-пуп успешная перезагрузка"
  player-only: "&cЭта команда доступна только от имени игрока!"

another:
  # Доступные плейсхолдеры:
  # %count% - количество оставшихся существ
  # %wave% - номер текущей волны
  info: "&eОсталось %count% существ."
```

**Плейсхолдеры для команды info:**
- `%kmobwaves_count%` - заменяется на количество оставшихся мобов
- `%kmobwaves_wave%` - заменяется на номер текущей волны

## Команды

### Основные команды

- `/kmobwaves` или `/kmw` - главная команда плагина

### Подкоманды

| Команда | Описание | Разрешение | Пример |
|---------|----------|------------|--------|
| `start` | Запускает волны с первой волны | `kmobwaves.admin` | `/kmobwaves start` или `/kmw start` |
| `force_start <номер>`<br/>`forcestart <номер>` | Запускает волны с указанной волны | `kmobwaves.admin` | `/kmobwaves force_start 3` или `/kmw forcestart 3` |
| `stop` | Останавливает все активные волны | `kmobwaves.admin` | `/kmobwaves stop` или `/kmw stop` |
| `info` | Показывает количество оставшихся мобов и текущую волну | `kmobwaves.user` | `/kmobwaves info` или `/kmw info` |
| `reload` | Перезагружает плагин | `kmobwaves.admin` | `/kmobwaves reload` или `/kmw reload` |

### Примеры использования

```
/kmobwaves start              # Запустить волны с начала
/kmobwaves force_start 3      # Запустить с третьей волны
/kmobwaves stop               # Остановить волны
/kmobwaves info               # Проверить статус
/kmobwaves reload             # Перезагрузить плагин
```

**Примечание**: Все команды можно использовать как с полным названием `/kmobwaves`, так и с алиасом `/kmw`. Команда `force_start` также поддерживает вариант `forcestart` (без подчеркивания).

## Разрешения

| Разрешение | Описание |
|------------|----------|
| `kmobwaves.admin` | Полный доступ ко всем командам (start, stop, reload, force_start) |
| `kmobwaves.user` | Доступ только к команде info |

## Как это работает

1. **Запуск волны**: При использовании `/kmobwaves start` или `/kmobwaves force_start <номер>` загружаются волны из конфига и начинается спавн мобов.

2. **Спавн мобов**: 
   - Мобы выбираются из списка согласно указанным шансам
   - Спавн происходит на случайных координатах из списка координат волны
   - Каждый моб отслеживается системой

3. **Завершение волны**: 
   - Когда все мобы волны убиты, начинается отсчет задержки (параметр `exceptions`)
   - После задержки автоматически запускается следующая волна

4. **Циклический режим**: После завершения последней волны система автоматически перезапускается с первой волны

## Отладка

Включите режим отладки в `config.yml`:
```yaml
debug: true
```

Это выведет подробную информацию о:
- Загрузке волн
- Спавне мобов
- Смерти мобов
- Завершении волн
- Переходах между волнами

## Решение проблем

### Мобы не спавнятся

1. **Проверьте MythicMobs**: Убедитесь, что плагин MythicMobs установлен и работает корректно
2. **Проверьте имена мобов**: Имена мобов в конфиге должны точно совпадать с именами мобов в MythicMobs (регистр важен)
3. **Проверьте координаты**: Убедитесь, что координаты спавна валидны и находятся в загруженном мире
4. **Режим отладки**: Включите `debug: true` в конфиге и проверьте логи сервера на наличие ошибок
5. **Проверьте мир**: Если используете координаты без указания мира, убедитесь, что на сервере есть хотя бы один загруженный мир

### Волна не переходит к следующей

1. **Все мобы убиты**: Убедитесь, что все мобы текущей волны действительно убиты
2. **Проверьте логи**: Включите режим отладки и проверьте логи на наличие ошибок
3. **Параметр exceptions**: Убедитесь, что параметр `exceptions` указан в секундах и имеет валидное значение
4. **Активность волн**: Используйте `/kmobwaves info` чтобы проверить текущее состояние волн

### Ошибки при загрузке конфига

1. **Синтаксис YAML**: Проверьте синтаксис YAML - отступы должны быть пробелами (не табами), кавычки должны быть правильными
2. **Обязательные поля**: Убедитесь, что все обязательные поля указаны для каждой волны:
   - `count` - номер волны
   - `mobs` - список мобов
   - `coordinates` - список координат
   - `mobs-count` - количество мобов
   - `exceptions` - задержка между волнами
3. **Формат координат**: Проверьте, что координаты указаны в правильном формате: `"x,y,z"` или `"world,x,y,z"`
4. **Формат мобов**: Убедитесь, что мобы указаны в формате `"ИмяМоба"` или `"ИмяМоба:шанс"`

### Команда force_start не находит волну

1. **Проверьте номер волны**: Убедитесь, что волна с указанным номером (`count`) существует в конфиге
2. **Порядок волн**: Номера волн не обязательно должны идти по порядку, но они должны существовать в конфиге
3. **Регистр**: Убедитесь, что вы используете правильный номер волны (число, не строка)

## Поддержка

При возникновении проблем:
1. Включите режим отладки (`debug: true`)
2. Проверьте логи сервера
3. Убедитесь, что все зависимости установлены
4. Проверьте конфигурацию на наличие ошибок

## Важные замечания

- **Имена мобов**: Имена мобов в конфиге должны точно совпадать с именами мобов в MythicMobs (регистр имеет значение)
- **Координаты**: Если не указываете мир в координатах, используется первый доступный мир сервера
- **Шансы спавна**: Шансы суммируются и нормализуются автоматически, поэтому можно использовать любые значения
- **Бесконечные волны**: После завершения последней волны система автоматически перезапускается с первой волны
- **Отслеживание мобов**: Система отслеживает только мобов, заспавненных через плагин. Мобы, созданные другими способами, не учитываются

## Версия

**Текущая версия**: 1.0

## Автор

vv0t3afa9

**Контакты**: t.me/kapybarkaaa

## Лицензия

Этот плагин предоставляется "как есть" без каких-либо гарантий.

